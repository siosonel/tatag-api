{	
	"@id": "/definitions/defs.json",
	"@type": "definitions",
	
	"resourceTypes": [
		"user",
		"userMemberships",
		"userAccounts",
		"userRatings",
		
		"brand",
		"brandMembers",
		"brandAccounts",
		
		"brandHolders",
		"memberAccounts",
		"accountHolders",
		
		"#userAbout",
		"#brandAbout",
		
		"userCollection",
		"brandCollection",

		"budgetIssued",
		"budgetTransferred",
		"budgetUsed",
		
		"accountRecords",
		"budgetRecords",
		
		"team",
		"teamMembers",
		"teamAccounts",
		"teamThrottles",
		
		"budgetThrottles",
		"throttle",
		
		"holderRelays",
		"relay",
		
		"promo",
		"brandPromos",
		"promoCollection"
	],

	"user": {		
		"description": "Personal information for the authorized user.", 		
		
		"properties": {
			"required": ["@type", "@id", "user_id", "name", "email"],
			"optional": ["links", "actions", "userMemberships", "userAccounts", "login_provider"]
		},	
		
		"relatedActions": {
			"brandCollection": ["/form/brand-registration"],
			"promoCollection": ["/form/promo-search"]
		},
		
		"actions": [{
			"title": "Edit",
			"@type": "form",
			"@id": "/form/user-edit",
			"method": "POST",
			
			"inputs": {
				"optional": ["name","email"],
				"required": []
			},
			
			"examples": [{
				"label": "should allow edits to username",
				"target": "/user/21",
				"method": "POST",
				"inputs": {
					"name": "esoi-{xtime}"
				},
				"status": 200
			},{
				"label": "should not allow edits to registered date",
				"target": "/user/21",
				"method": "POST",
				"inputs": {
					"created": "2015-01-01"
				},
				"status": 403
			}]
		},{
			"title": "Deactivate",
			"@type": "form",
			"@id": "/form/user-deactivate",
			"method": "DELETE"
		}]
	},

	"userMemberships": {
		"description": "A user's list of memberships in brands, encoded as an array of brand member properties.",
		
		"properties": {
			"required": ["@type", "@id", "user_id", "items"],
			"optional": ["links", "actions"]
		},
		
		"actions": [{
			"title": "Accept or Rescind Membership",
			"@type": "form",
			"@id": "/form/member-edit",
			"method": "POST",
			
			"query": {
				"required": ["member_id"],
				"optional": []				
			},
			
			"inputs": {
				"required": [],
				"optional": ["joined","revoked"]	
			},
			
			"examples": [{
				"label": "should allow a member to edit joined or revoked date",
				"target": "/user/21/brands",
				"method": "POST",				
				"query": {
					"member_id": 53
				},				
				"inputs": {
					"joined": "{xtime}"
				},
				"status": 200
			},{
				"label": "should NOT allow non-admin edits of a member's hours",
				"target": "/user/21/brands",
				"method": "POST",				
				"query": {
					"member_id": 54
				},				
				"inputs": {
					"hours": "{random}"
				},
				"status": 403
			}]
		}]
	},

	"userAccounts": {
		"description": "One or more budget accounts held by the user.",
		
		"properties": {
			"required": ["@type", "@id", "user_id", "items"],
			"optional": ["links", "actions"]
		},
		
		"actions": [{
			"title": "Edit",
			"@type": "form",
			"@id": "/form/holder-edit",
			"method": "POST",
			
			"query": {
				"required": ["holder_id"],
				"optional": []
			},
			
			"inputs": {
				"required": [],
				"optional": ["alias", "limkey"]
			},
			
			"examples": [{
				"label": "should allow a holder to edit the accountholding's alias",
				"target": "/user/21/accounts",
				"method": "POST",				
				"query": {
					"holder_id": 41
				},				
				"inputs": {
					"alias": "nickname-{xtime}"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-holder to edit an account's alias",
				"target": "/user/21/accounts",
				"method": "POST",				
				"query": {
					"holder_id": 44
				},				
				"inputs": {
					"alias": "nickname-{xtime}"
				},
				"status": 403
			}]
		}],
		
		"relatedActions": {
			"budgetIssued": ["/form/budget-add"],
			"budgetTransferred": ["/form/budget-transfer"],
			"budgetUsed": ["/form/budget-use"]
		}
	},
	
	"userCollection": {
		"description": "Default user collection resource, non-admin, non-self.",
		
		"properties": {
			"required": ["@type", "@id", "numUsers", "earliest", "latest"],
			"optional": ["links", "actions"]
		},
		
		"actions": [{
			"title": "User registration",
			"@type": "form",
			"@id": "/form/user-registration",
			"method": "POST",
			
			"inputs": {
				"required": ["email", "password", "name"],
				"optional": []
			},
			
			"examples": [{
				"label": "should allow registration by a brand new user",
				"target": "/user/collection",
				"method": "POST",			
				
				"inputs": {
					"email": "john-{random}@test.org",
					"name": "John-{random}",
					"password": "pass2"
				},
				"status": 200
			},{
				"label": "should NOT allow user registration with missing email",
				"target": "/user/collection",
				"method": "POST",				
						
				"inputs": {
					"name": "John-{random}",
					"password": "pass2"
				},
				"status": 400
			}]
		}]
	},
	
	"userRatings": {
		"description": "A user's ratings of brands.",

		"properties": {
			"required": ["@type", "@id", "user_id", "items"],
			"optional": ["links", "actions", "pageOrder", "itemsLimit", "next", "prev"]
		},
		
		"actions": [
		{
			"title": "Add a rating",
			"@type": "form",
			"@id": "/form/rating-add",
			"method": "POST",
			
			"inputs": {
				"required": ["brand_id", "rating", "reason"],
				"optional": []
			},
			
			"examples": [{
				"label": "should allow a user to add a new rating",
				"target": "/user/21/ratings",
				"method": "POST",
				
				"inputs": {
					"brand_id": 105,
					"rating": 0,
					"reason": "polluter"
				},
				"status": 200
			},{
				"label": "should allow a user to add a new rating for a previously unregistered brand",
				"target": "/user/21/ratings",
				"method": "POST",
				
				"inputs": {
					"brand_id": "test test test {random}",
					"rating": 0,
					"reason": "polluter"
				},
				"status": 200
			},{
				"label": "should not allow a user to duplicate an existing rating, by other_id",
				"target": "/user/21/ratings",
				"method": "POST",
				
				"inputs": {
					"brand_id": 105,
					"rating": 0,
					"reason": "polluter"
				},
				"status": 200
			}]
		},
		{
			"title": "Update a rating",
			"@type": "form",
			"@id": "/form/rating-edit",
			"method": "POST",
			
			"inputs": {
				"required": [],
				"optional": ["rating","reason","ended"]
			},
			
			"query": {
				"required": ["rating_id"],
				"optional": []				
			},
			
			"examples": [{
				"label": "should allow a user to update a rating",
				"target": "/user/21/ratings?rating_id=1",
				"method": "POST",
				
				"inputs": {
					"rating": 1,
					"reason": "non-polluter {random}"
				},
				"status": 200
			}]
		}]
	},
	
	
	"brand": {
		"description": "An admin's view of a budget-issuing organization.",

		"properties": {
			"required": ["@type", "@id", "brand_id", "name", "mission", "description", "created", "tally"],
			"optional": ["links", "actions", "url", "advisor", "type_system", "type_id", "country_code", "area_code", "logo", "brand_name"]
		},
		
		"actions": [{
			"title": "Edit",
			"@type": "form",
			"@id": "/form/brand-edit",
			"method": "POST",
			
			"inputs": {
				"required": [],
				"optional": ["name", "url", "mission", "description", "url", "advisor", "type_system", "type_id", "country_code", "area_code", "logo"]
			},
			
			"examples": [{
				"label": "should allow an admin to edit a brand's info",
				"target": "/brand/104",
				"method": "POST",
				"inputs": {
					"mission": "another mission -{xtime}",
					"description": "another description -{xtime}"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-admin to edit a brand's alias",
				"target": "/brand/105",
				"method": "POST",				
				"query": {
					"holder_id": 44
				},				
				"inputs": {
					"mission": "non-admin's brand mission -{xtime}",
					"description": "non-admin's brand description -{xtime}"
				},
				"status": 403
			}]
		}]
	},
	
	"brandMembers": {
		"description": "All users that are current members of a brand.",

		"properties": {
			"required": ["@type", "@id", "brand_id", "items"],
			"optional": ["links", "actions", "pageOrder", "itemsLimit", "next", "prev"]
		},
		
		"actions": [
		{
			"title": "Edit",
			"@type": "form",
			"@id": "/form/admin-member-edit",
			"method": "POST",
			
			"inputs": {
				"required": [],
				"optional": ["role", "hours"]
			},
			
			"examples": [{
				"label": "should allow an admin to edit a member's info",
				"target": "/brand/104/members",
				"method": "POST",
				
				"query": {
					"member_id": 55
				},					
				
				"inputs": {
					"role": "assistant -{xtime}",
					"hours": "{random}"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-admin to edit a member's info",
				"target": "/brand/105/members",
				"method": "POST",				
				"query": {
					"member_id": 54
				},					
				
				"inputs": {
					"role": "assistant -{xtime}",
					"hours": "{random}"
				},
				"status": 403
			}]
		},
		{
			"title": "Add a member",
			"@type": "form",
			"@id": "/form/member-add",
			"method": "POST",
			
			"inputs": {
				"required": ["user_id", "role", "hours"],
				"optional": []
			},
			
			"examples": [{
				"label": "should allow an admin to add a brand member",
				"target": "/brand/104/members",
				"method": "POST",
				
				"inputs": {
					"user_id": 24,
					"role": "dev-{xtime}",
					"hours": "{random}"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-admin to add a member",
				"target": "/brand/105/members",
				"method": "POST",				
				
				"inputs": {
					"user_id": 24,
					"role": "dev-{xtime}",
					"hours": "{random}"
				},
				"status": 403
			}]
		}]
	},
	
	"brandAccounts": {
		"description": "The accounts administered by a brand.",

		"properties": {
			"required": ["@type", "@id", "brand_id", "items"],
			"optional": ["links", "actions", "pageOrder", "itemsLimit", "next", "prev"]
		},
		
		"actions": [
		{
			"title": "Edit",
			"@type": "form",
			"@id": "/form/admin-account-edit",
			"method": "POST",
			
			"inputs": {
				"required": [],
				"optional": ["name", "authcode", "throttle_id"]
			},
			
			"examples": [{
				"label": "should allow an admin to edit an account's info",
				"target": "/brand/104/accounts",
				"method": "POST",
				
				"query": {
					"account_id": 94
				},					
				
				"inputs": {
					"name": "my -{xtime}",
					"authcode": "ft -{random}"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-admin to edit an account's info",
				"target": "/brand/105/accounts",
				"method": "POST",				
				"query": {
					"account_id": 97
				},					
				
				"inputs": {
					"name": "my -{xtime}",
					"authcode": "{random}"
				},
				"status": 403
			}]
		},
		{
			"title": "Add an account",
			"@type": "form",
			"@id": "/form/account-add",
			"method": "POST",
			
			"inputs": {
				"required": ["name", "authcode", "unit", "sign"],
				"optional": []
			},
			
			"examples": [{
				"label": "should allow an admin to add a new account",
				"target": "/brand/104/accounts",
				"method": "POST",
				
				"inputs": {
					"name": "test -{xtime}",
					"authcode": "cftix",
					"unit": "hour"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-admin to add a member",
				"target": "/brand/105/accounts",
				"method": "POST",				
				
				"inputs": {
					"name": "test -{xtime}",
					"authcode": "cftix",
					"unit": "hour"
				},
				"status": 403
			}]
		}]
	},
	
	"brandHolders": {
		"description": "Those users who are currently assigned an account administered by a brand.",

		"properties": {
			"required": ["@type", "@id", "brand_id", "items"],
			"optional": ["links", "actions", "pageOrder", "itemsLimit", "next", "prev"]
		},
		
		"actions": [
		{
			"title": "Edit",
			"@type": "form",
			"@id": "/form/admin-holder-edit",
			"method": "POST",
			
			"inputs": {
				"required": ["authcode"],
				"optional": []
			},		
		
			"examples": [{
				"label": "should allow an admin to edit a holder's authcode",
				"target": "/brand/104/holders",
				"method": "POST",
				
				"query": {
					"holder_id": 43
				},					
				
				"inputs": {
					"authcode": "ftix -{random}"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-admin to edit an account's info",
				"target": "/brand/105/holders",
				"method": "POST",				
				"query": {
					"holder_id": 44
				},					
				
				"inputs": {
					"name": "my -{xtime}",
					"authcode": "{random}"
				},
				"status": 403
			}]
		},
		{
			"title": "Add an account holder",
			"@type": "form",
			"@id": "/form/holder-add",
			"method": "POST",
			
			"inputs": {
				"required": ["user_id", "account_id", "authcode"],
				"optional": []
			},
			
			"examples": [{
				"label": "should allow an admin to add a new accountholder",
				"target": "/brand/104/holders",
				"method": "POST",
				
				"inputs": {
					"user_id": 24,
					"account_id": 94,
					"authcode": "cftix"
				},
				"status": 200
			},{
				"label": "should NOT allow an admin to add a new accountholder",
				"target": "/brand/105/holders",
				"method": "POST",
				
				"inputs": {
					"user_id": 24,
					"account_id": 96,
					"authcode": "cftix"
				},
				"status": 403
			}]
		}]
	},
	
	"budgetThrottles": {
		"description": "The inflow throttles administered by a brand.",

		"properties": {
			"required": ["@type", "@id", "brand_id", "items"],
			"optional": ["links", "actions"]
		},
		
		"relatedActions": {
			"throttle": ["/form/admin-throttle-edit"]
		},
		
		"actions": [
		{
			"title": "Add an inflow throttle",
			"@type": "form",
			"@id": "/form/throttle-add",
			"method": "POST",
			
			"inputs": {
				"required": ["period", "by_all", "by_brand", "by_user"],
				"optional": []
			},
			
			"examples": [{
				"label": "should allow an admin to add a new throttle",
				"target": "/budget/104/throttles",
				"method": "POST",
				
				"inputs": {
					"period": "360000",
					"by_all": "100",
					"by_brand": "20",
					"by_user": "2"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-admin to add a throttle",
				"target": "/budget/105/throttles",
				"method": "POST",				
				
				"inputs": {
					"period": "360000",
					"by_all": "100",
					"by_brand": "20",
					"by_user": "2"
				},
				"status": 403
			}]
		}]
	},
		
	"memberAccounts": {
		"description": "A brand's accountholdings, filtered for a specific member_id.",
		"testURL": "/member/53/accounts",

		"properties": {
			"required": ["@type", "@id", "brand_id", "items", "member_id", "role", "created", "hours", "user_id"],
			"optional": ["links", "actions", "pageOrder", "itemsLimit", "next", "prev"]
		},
		
		"relatedActions": {
			"brandHolders": ["/form/admin-holder-edit", "forms#holder-add"]
		},
		
		"actions": [
		{
			"title": "Edit",
			"@type": "form",
			"@id": "/form/admin-holder-edit",
			"method": "POST",
			
			"inputs": {
				"required": ["authcode"],
				"optional": []
			},		
		
			"examples": [{
				"label": "should allow an admin to edit a holder's authcode",
				"target": "/member/57/accounts?holder_id=46",
				"method": "POST",
				
				"inputs": {
					"authcode": "ftix -{random}"					
				},
				"status": 200
			},{
				"label": "should NOT allow a non-admin to edit an account's info",
				"target": "/member/54/accounts?holder_id=45",
				"method": "POST",					
				"inputs": {
					"name": "my -{xtime}",
					"authcode": "{random}"
				},
				"status": 403
			}]
		},
		{
			"title": "Add an account holder",
			"@type": "form",
			"@id": "/form/holder-add",
			"method": "POST",
			
			"inputs": {
				"required": ["user_id", "account_id", "authcode"],
				"optional": []
			},
			
			"examples": [{
				"label": "should allow an admin to add a new accountholder",
				"target": "/member/57/accounts",
				"method": "POST",
				
				"inputs": {
					"user_id": 24,
					"account_id": 92,
					"authcode": "cftix"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-admin to add a new accountholder",
				"target": "/member/54/accounts",
				"method": "POST",
				
				"inputs": {
					"user_id": 22,
					"account_id": 92,
					"authcode": "cftix"
				},
				"status": 403
			}]
		}]
	},
	
	"accountHolders": {
		"description": "A brand's accountholders, filtered for a specific account_id.",
		"testURL": "/account/92/holders",

		"properties": {
			"required": ["@type", "@id", "brand_id", "items", "account_id"],
			"optional": ["links", "actions", "pageOrder", "itemsLimit", "next", "prev"]
		},
		
		"relatedActions": {
			"brandHolders": ["/form/admin-holder-edit", "forms#holder-add"]
		},
		
		"actions": []
	},
	
	"brandAbout": {
		"description": "General information about a brand.",

		"properties": {
			"required": ["name", "mission", "description"],
			"optional": ["url", "advisor", "type_system", "type_id", "country_code", "area_code"]
		},
		
		"actions": {}
	},
		
	"brandCollection": {
		"description": "Default brand collection resource, non-admin, non-self.",
		
		"properties": {
			"required": ["@type", "@id", "items",	"numBrands", "earliest", "latest"],
			"optional": ["links", "actions", "pageOrder", "itemsLimit", "next", "prev"]
		},
		
		"actions": [{
			"title": "Brand registration",
			"@type": "form",
			"@id": "/form/brand-registration",			
			"method": "POST",
			"target": "/brand/collection",
			
			"inputs": {
				"required": ["name", "mission", "description"],
				"optional": ["url", "advisor", "type_system", "type_id", "country_code", "area_code"]
			},
			
			"examples": [{
				"label": "should allow registration by a brand new user",
				"target": "/brand/collection",
				"method": "POST",			
				
				"inputs": {
					"name": "abc-{xtime}.org",
					"mission": "To be the third brand - {xtime}",
					"description": "the third brand"
				},
				"status": 200
			},{
				"label": "should NOT allow user registration with missing mission",
				"target": "/brand/collection",
				"method": "POST",				
							
				"inputs": {
					"name": "xyz-{xtime}.org",
					"description": "the third brand"
				},
				"status": 403
			}]
		}]
	},
	
	"budgetIssued": {
		"description": "The first part of the budget lifecycle, with the brand issuing equivalent debits and credits to its N and P-type accounts, respectively.",
		"testURL": "/budget/104/issued",
		
		"properties": {
			"required": ["@type", "@id", "brand_id", "items"],
			"optional": ["links", "actions"]
		},
		
		"actions": [
		{
			"title": "Issue budget",
			"@type": "form",
			"@id": "/form/budget-add",			
			"method": "POST",
			"target": "/budget/issued",
			
			"query": {
				"required": ["brand_id"],
				"optional": []				
			},
			
			"inputs": {
				"required": ["from", "to", "amount", "note"],
				"optional": []
			},
			
			"examples": [{
				"label": "should allow an accountholding with a 'c' authcode to issue budget",
				"target": "/budget/104/issued",
				"method": "POST",
				
				"inputs": {
					"from": "41-abc",
					"to": "42-abc",
					"amount": 200,
					"note": "test budget issuance"
				},
				"status": 200
			},{
				"label": "should NOT allow an accountholding without a 'c' authcode to issue budget",
				"target": "/budget/104/issued",
				"method": "POST",
				
				"inputs": {
					"from": "41-abc",
					"to": "43-abc",
					"amount": 200,
					"note": "test budget issuance"
				},
				"status": 403
			}]
		},
		{
			"title": "Reverse issued budget",
			"@type": "form",
			"@id": "/form/budget-unadd",
			"method": "POST",
			"target": "/budget/issued",
			
			"query": {
				"required": ["brand_id"],
				"optional": []				
			},
			
			"inputs": {
				"required": ["from", "to", "amount", "note", "orig_record_id"],
				"optional": []
			},
		
			"examples": [{
				"label": "should allow reversal of issued budget",
				"target": "/budget/104/issued",
				"method": "POST",
				
				"inputs": {
					"from": "41-abc",
					"to": "42-abc",
					"amount": -20,
					"note": "test issued budget reversal",
					"orig_record_id": 30
				},
				"status": 200
			}]
		}]
	},	
	
	"budgetTransferred": {
		"description": "The intermediate part of the budget lifecycle, with budgets being transferred between accounts of the same brand.",
		"testURL": "/budget/104/transferred",
	
		"properties": {
			"required": ["@type", "@id", "brand_id", "items"],
			"optional": ["links", "actions"]
		},
		
		"actions": [
		{
			"title": "Transfer budget",
			"@type": "form",
			"@id": "/form/budget-transfer",
			"method": "POST",
			"target": "/budget/transferred",
			
			"query": {
				"required": ["brand_id"],
				"optional": []				
			},
			
			"inputs": {
				"required": ["from", "to", "amount", "note"],
				"optional": []
			},
			
			"examples": [{
				"label": "should allow an originating accountholding with an 'f' and destination accountholding with a 't' authcode to transfer budgets.",
				"target": "/budget/104/transferred",
				"method": "POST",
				
				"inputs": {
					"from": "42-abc",
					"to": "43-abc",
					"amount": 22.00,
					"note": "test budget transfer"
				},
				"status": 200
			}]
		},
		{
			"title": "Reverse transferred budget",
			"@type": "form",
			"@id": "/form/budget-untransfer",
			"method": "POST",
			"target": "/budget/transferred",
			
			"query": {
				"required": ["brand_id"],
				"optional": []				
			},
			
			"inputs": {
				"required": ["from", "to", "amount", "note", "orig_record_id"],
				"optional": []
			},
			
			"examples": [{
				"label": "should allow reversal of transferred budget",
				"target": "/budget/104/transferred",
				"method": "POST",
				
				"inputs": {
					"from": "42-abc",
					"to": "43-abc",
					"amount": -2.05,
					"note": "test transferred budget reversal",
					"orig_record_id": 31
				},
				"status": 200
			}]			
		}]
	},
	
	"budgetUsed": {
		"description": "The last part of the budget lifecycle, with credits getting cancelled with an equivalent amount of debits, mostly expected to be between brands.",
		"testURL": "/budget/104/used",
		
		"properties": {
			"required": ["@type", "@id", "brand_id", "items"],
			"optional": ["links", "actions"]
		},
		
		"actions": [
		{
			"title": "Use budget",
			"@type": "form",
			"@id": "/form/budget-use",
			"method": "POST",
			"target": "/budget/used",
			
			"query": {
				"required": ["brand_id"],
				"optional": []				
			},
			
			"inputs": {
				"required": ["from", "to", "amount", "note"],
				"optional": []
			},
			
			"examples": [{
				"label": "should allow an accountholding with an 'x' to use budgets.",
				"target": "/budget/104/used",
				"method": "POST",
				
				"inputs": {
					"from": "42-abc",
					"to": "44-abc",
					"amount": 11.11,
					"note": "test budget use"
				},
				"status": 200
			},{
				"label": "should allow the use of a valid relay credential to authorize a transaction.",
				"target": "/budget/104/used",
				"method": "POST",
				
				"inputs": {
					"from": "42-abc",
					"to": "3.xyz",
					"amount": 1.11,
					"note": "test budget use"
				},
				"status": 200
			},{
				"label": "should void the transaction when the transaction amount is not within a relay's amount_min and _max",
				"target": "/budget/104/used",
				"method": "POST",
				
				"inputs": {
					"from": "42-abc",
					"to": "3.xyz",
					"amount": 51.11,
					"note": "test budget use"
				},
				"status": 403
			},{
				"label": "should fill-in missing transaction amount",
				"target": "/budget/104/used",
				"method": "POST",
				
				"inputs": {
					"from": "42-abc",
					"to": "3.xyz",
					"note": "test budget use"
				},
				"status": 200
			},{
				"label": "should not allow relay usage that exceeds limits",
				"target": "/budget/104/used",
				"method": "POST",
				
				"inputs": {
					"from": "42-abc",
					"to": "4.qrs",
					"amount": 0.12,
					"note": "test budget use"
				},
				"status": 403
			},{
				"label": "should convert promo to correct record info",
				"target": "/budget/104/used",
				"method": "POST",
				
				"inputs": {
					"from": "42-abc",
					"to": "promo-1",
					"note": "test budget use"
				},
				"status": 200
			}]
		},
		{
			"title": "Reverse used budget",
			"@type": "form",
			"@id": "/form/budget-unuse",
			"method": "POST",
			"target": "/budget/used",
			
			"query": {
				"required": ["brand_id"],
				"optional": []				
			},
			
			"inputs": {
				"required": ["from", "to", "amount", "note", "orig_record_id"],
				"optional": []
			},
			
			"examples": [{
				"label": "should allow reversal of used budget",
				"target": "/budget/104/used",
				"method": "POST",
				
				"inputs": {
					"from": "45-abc",
					"to": "41-abc",
					"amount": -1.01,
					"note": "test used budget reversal",
					"orig_record_id": 34
				},
				"status": 200
			}]
		}]
	},
	
	"accountRecords": {
		"description": "An accounts transaction activity.",
		"testURL": "/account/92/records",
		
		"properties": {
			"required": ["@type", "@id", "account_id", "brand_id", "items", "holder_id", "limkey"],
			"optional": ["links", "actions", "advisor", "pageOrder", "itemsLimit", "next", "prev"]
		},
		
		"relatedActions": {
			"budgetIssued": ["/form/budget-unadd"],
			"budgetTransferred": ["/form/budget-untransfer"],
			"budgetUsed": ["/form/budget-unuse"]
		},
		
		"actions": [
		{
			"title": "Hold transaction (disable auto-approval)",
			"@type": "form",
			"@id": "/form/record-hold",
			"method": "POST",
			
			"query": {
				"required": ["record_id"],
				"optional": []				
			},
			
			"inputs": {
				"required": ["status"],
				"optional": [],
				"valueRestrictions": {
					"status": [5]
				}
			},
			
			"examples": [{
				"label": "should allow putting record on hold",
				"target": "/account/92/records",
				"method": "POST",
				
				"query": {
					"record_id": 30
				},
				
				"inputs": {
					"status": 5
				},
				"status": 200
			}]
		},
		{
			"title": "Manually approve transaction",
			"@type": "form",
			"@id": "/form/record-approve",
			"method": "POST",
			
			"query": {
				"required": ["record_id"],
				"optional": []				
			},
			
			"inputs": {
				"required": ["status"],
				"optional": [],
				"valueRestrictions": {
					"status": [7]
				}
			},
			
			"examples": [{
				"label": "should allow record approval",
				"target": "/account/92/records",
				"method": "POST",
				
				"query": {
					"record_id": 30
				},
				
				"inputs": {
					"status": 7
				},
				"status": 200
			}]
		},
		{
			"title": "Manually reject transaction",
			"@type": "form",
			"@id": "/form/record-reject",
			"method": "POST",
			
			"query": {
				"required": ["record_id"],
				"optional": []				
			},
			
			"inputs": {
				"required": ["status"],
				"optional": [],
				"valueRestrictions": {
					"status": [-10]
				}
			},
			
			"examples": [{
				"label": "should allow record rejection",
				"target": "/account/92/records",
				"method": "POST",
				
				"query": {
					"record_id": 30
				},
				
				"inputs": {
					"status": -10
				},
				"status": 200
			}]
		}]
	},

	"budgetRecords": {
		"description": "Transaction records of a brand, by transaction type.",
		"testURL": "/account/92/records",
		
		"properties": {
			"required": ["@type", "@id", "brand_id"],
			"optional": ["links", "actions", "subtype", "txntype"]
		},
		
		"readOnly": true,
		
		"actions": []
	},
	
	"team": {
		"description": "A member's non-admin view of a budget-issuing organization.",

		"properties": {
			"required": [
				"@type", "@id", "brand_id", "name", "mission", "description", "created", "tally",
				"member_id", "role", "hours", "joined", "revoked", "url", "advisor"
			],
			"optional": ["links", "actions", "type_system", "type_id", "country_code", "area_code", "area_name", "brand_name"]
		},
		
		"actions": [
		{
			"title": "Accept Membership",
			"@type": "form",
			"@id": "/form/member-accept",
			"method": "POST",
			
			"query": {
				"required": ["member_id"],
				"optional": []				
			},
			
			"inputs": {
				"required": ["joined"],
				"optional": []	
			},
			
			"examples": [{
				"label": "should allow a member to accept membership by providing a joined date",
				"target": "/team/104/",
				"method": "POST",				
				"query": {
					"member_id": 53
				},				
				"inputs": {
					"joined": "{xtime}"
				},
				"status": 200
			}]
		},
		{
			"title": "Revoke Membership",
			"@type": "form",
			"@id": "/form/member-revoke",
			"method": "POST",
			
			"query": {
				"required": ["member_id"],
				"optional": []				
			},
			
			"inputs": {
				"required": ["revoked"],
				"optional": []	
			},
			
			"examples": []
		}]
	},

	"teamMembers": {
		"description": "Non-admin view of all users that are current members of a brand.",
		"readOnly": 1,
		
		"properties": {
			"required": ["@type", "@id", "brand_id", "items"],
			"optional": ["links", "actions", "pageOrder", "itemsLimit", "next", "prev"]
		}
	},
	
	"teamAccounts": {
		"description": "Non-admin view of the current accounts of a brand.",
		"readOnly": 1,
		
		"properties": {
			"required": ["@type", "@id", "brand_id", "items"],
			"optional": ["links", "actions", "pageOrder", "itemsLimit", "next", "prev"]
		}
	},
	
	"teamThrottles": {
		"description": "The inflow throttles administered by a brand.",
		"readOnly": 1,

		"properties": {
			"required": ["@type", "@id", "brand_id", "items"],
			"optional": ["links", "actions"]
		}
	},
	
	"throttle": {	
		"description": "An item in the brandthrottles collection.",
		"testURL": "/throttle/1",
		
		"properties": {
			"required": ["@type", "@id", "brand_id", "throttle_id", "period", "by_all", "by_brand", "by_user", "created", "updated", "ended", "productURL"],
			"optional": ["links", "actions"]
		},
		
		"actions": [{
			"title": "Edit",
			"@type": "form",
			"@id": "/form/admin-throttle-edit",
			"method": "POST",
			
			"inputs": {
				"required": [],
				"optional": ["period", "by_all", "by_brand", "by_user"]
			},
			
			"examples": [{
				"label": "should allow an admin to edit a throttle's specifications",
				"target": "/throttle/1",
				"method": "POST",
				
				"inputs": {
					"period": "99999999"
				},
				"status": 200
			}]
		}]
	},
	
	"holderRelays": {	
		"description": "An accountholder's collection of relay information.",
		"testURL": "/holder/41/relays",
		
		"properties": {
			"required": ["@type", "@id", "items", "holder_id"],
			"optional": ["links", "actions", "pageOrder", "itemsLimit"]
		},
		
		"relatedActions": {
			"relay": ["/form/relay-edit"]
		},
		
		"actions": [{
			"title": "Add",
			"@type": "form",
			"@id": "/form/holder-relays-add",
			"method": "POST",
			
			"inputs": {
				"required": [],
				"optional": ["amount_min", "amount_max", "redirect", "tag", "secret", "txntype", "ended",
				"by_all_limit","by_brand_limit","by_user_limit","by_user_wait"]
			},
			
			"examples": [{
				"label": "should allow an accountholder to add a relay specification",
				"target": "/holder/41/relays",
				"method": "POST",
				
				"inputs": {
					"amount_min": 0,
					"amount_max": "{random}"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-accountholder to add a relay specification",
				"target": "/holder/44/relays",
				"method": "POST",
				
				"inputs": {
					"amount_min": 0,
					"amount_max": "{random}"
				},
				"status": 403
			}]
		}]
	},
	
	"relay": {	
		"description": "An accountholder's relay information.",
		"testURL": "/relay/1",
		
		"properties": {
			"required": ["@id", "@type", "relay_id", "holder_id", "amount_min", "amount_max", "redirect", "tag", "secret", "txntype",
				"by_all_limit","by_brand_limit","by_user_limit","by_user_wait"],
			"optional": ["links", "actions", "user_id", "account_id", "created", "updated"]
		},
		
		"actions": [{
			"title": "Edit",
			"@type": "form",
			"@id": "/form/relay-edit",
			"method": "POST",
			
			"inputs": {
				"required": [],
				"optional": ["amount_min", "amount_max", "redirect", "tag", "secret", "txntype", "ended",
				"by_all_limit","by_brand_limit","by_user_limit","by_user_wait"]
			},
			
			"examples": [{
				"label": "should allow an accountholder to edit a relay specification",
				"target": "/relay/1",
				"method": "POST",
				
				"inputs": {
					"secret": "{hex}",
					"amount_max": "{random}"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-accountholder to edit a relay specification",
				"target": "/relay/3",
				"method": "POST",
				
				"inputs": {
					"secret": "{hex}",
					"amount_max": "{random}"
				},
				"status": 403
			}]
		}]
	},
	
	"promo": {	
		"description": "A brand's promo information.",
		"testURL": "/promo/1",
		
		"properties": {
			"required": ["@id", "@type", "promo_id", "brand_id", "name", "description", 
				"imageURL","infoURL","created","updated","expires",
				"by_all_limit","by_brand_limit","by_user_limit","by_user_wait"],
			"optional": ["links", "actions", "user_id", "account_id", "created", "updated"]
		},
		
		"relatedActions": {
			"relay": ["/form/relay-edit"]
		},
		
		"actions": [{
			"title": "Edit",
			"@type": "form",
			"@id": "/form/promo-edit",
			"method": "POST",
			
			"inputs": {
				"required": [],
				"optional": ["name", "description", "amount", "imageURL", "infoURL", "expires", "keyword"]
			},
			
			"examples": [{
				"label": "should allow a brand admin to edit a promo specification",
				"target": "/promo/1",
				"method": "POST",
				
				"inputs": {
					"name": "{hex}",
					"amount": "{random}"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-brand admin to edit a promo specification",
				"target": "/promo/2",
				"method": "POST",
				
				"inputs": {
					"name": "{hex}",
					"amount": "{random}"
				},
				"status": 403
			}]
		}]
	},
	
	"brandPromos": {	
		"description": "A brand's collection of promos.",
		
		"properties": {
			"required": ["@type", "@id", "items", "holder_id"],
			"optional": ["links", "actions", "pageOrder", "itemsLimit"]
		},
		
		"relatedActions": {
			"promo": ["/form/promo-edit"],
			"relay": ["/form/relay-edit"]
		},
		
		"actions": [{
			"title": "Add",
			"@type": "form",
			"@id": "/form/promo-add",
			"method": "POST",
			
			"inputs": {
				"required": ["name", "description", "amount", "holder_id"],
				"optional": ["imageURL", "infoURL", "expires", "by_all_limit", "by_brand_limit", "by_user_limit", "by_user_wait","keyword"]
			},
			
			"examples": [{
				"label": "should allow a brand member to add a promo specification",
				"target": "/brand/104/promos",
				"method": "POST",
				
				"inputs": {
					"name": "product promo {hex}",
					"description": "a brand 104 promo {hex}",
					"amount": "{random}",
					"holder_id": 41					
				},
				"status": 200
			},{
				"label": "should NOT allow a non-brand member to add a promo specification",
				"target": "/brand/105/promos",
				"method": "POST",
				
				"inputs": {
					"name": "product promo {hex}",
					"description": "a brand 105 promo {hex}",
					"amount": "{random}"
				},
				"status": 403
			},{
				"label": "should allow a brand member to add using the promo/collection endpoint",
				"target": "/promo/collection",
				"method": "POST",
				
				"inputs": {
					"name": "product promo {hex}",
					"description": "a brand 104 promo {hex}",
					"amount": "{random}",
					"holder_id": 41					
				},
				"status": 200
			}]
		}]
	},
	
	"promoCollection": {	
		"description": "A brand's collection of promos.",
		
		"properties": {
			"required": ["@type", "@id", "items", "holder_id"],
			"optional": ["links", "actions", "pageOrder", "itemsLimit"]
		},
		
		"relatedActions": {
			"budgetUsed": ["/form/budget-use"],
			"brandPromos": ["/form/promo-add"],
			"promo": ["/form/promo-edit"]
		},
		
		"actions": [{
			"title": "Search",
			"@type": "form",
			"@id": "/form/promo-search",
			"method": "POST",
			"target": "/promo/collection",
			
			"query": {
				"required": [],
				"optional": ["for"]				
			},
			
			"inputs": {},
			
			"examples": []
		}]
	}
}
	
