{	
	"@id": "/definitions/defs.json",
	"@type": "definitions",
	
	"resourceTypes": [
		"user",
		"userMemberships",
		"userAccounts",
		"#userFeed",
		
		"brand",
		"brandMembers",
		"brandAccounts",
		"brandHolders",
		"#brandFeed",
		
		"#userAbout",
		"#userWall",
		"#brandAbout",
		"#brandWall",
		
		"userCollection",
		"brandCollection",

		"budgetIssued",
		"budgetTransferred",
		"budgetUsed"
	],

	"user": {		
		"description": "Personal information for the authorized user.", 		
		
		"properties": {
			"required": ["@type", "@id", "user_id", "name", "email"],
			"optional": ["links", "actions", "userMemberships", "userAccounts"]
		},	
		
		"actions": [{
			"title": "Edit",
			"@type": "form",
			"@id": "/forms#user-edit",
			"method": "POST",
			
			"inputs": {
				"optional": ["name","email"],
				"required": []
			},
			
			"examples": [{
				"label": "should allow edits to username",
				"target": "/user/21",
				"method": "POST",
				"inputs": {
					"name": "esoi-{xtime}"
				},
				"status": 200
			},{
				"label": "should not allow edits to registered date",
				"target": "/user/21",
				"method": "POST",
				"inputs": {
					"created": "2015-01-01"
				},
				"status": 403
			}]
		},{
			"title": "Deactivate",
			"@type": "form",
			"@id": "/forms#user-deactivate",
			"method": "DELETE"
		}]
	},

	"userMemberships": {
		"description": "A user's list of memberships in brands, encoded as an array of brand member properties.",
		
		"properties": {
			"required": ["@type", "@id", "user_id", "items"],
			"optional": ["links", "actions"]
		},
		
		"actions": [{
			"title": "Edit",
			"@type": "form",
			"@id": "/forms#member-edit",
			"method": "POST",
			
			"query": {
				"required": ["member_id"],
				"optional": []				
			},
			
			"inputs": {
				"required": ["hours"],
				"optional": []	
			},
			
			"examples": [{
				"label": "should allow a member to edit his or her hours",
				"target": "/user/21/brands",
				"method": "POST",				
				"query": {
					"member_id": 53
				},				
				"inputs": {
					"hours": "{random}"
				},
				"status": 200
			},{
				"label": "should NOT allow non-admin edits of another member's hours",
				"target": "/user/21/brands",
				"method": "POST",				
				"query": {
					"member_id": 54
				},				
				"inputs": {
					"hours": "{random}"
				},
				"status": 403
			}]
		}]
	},

	"userAccounts": {
		"description": "One or more budget accounts held by the user.",
		
		"properties": {
			"required": ["@type", "@id", "user_id", "items"],
			"optional": ["links", "actions"]
		},
		
		"actions": [{
			"title": "Edit",
			"@type": "form",
			"@id": "/forms#holder-edit",
			"method": "POST",
			
			"query": ["holder_id"],
			
			"inputs": {
				"required": [],
				"optional": ["alias", "limkey"]
			},
			
			"examples": [{
				"label": "should allow a holder to edit the accountholding's alias",
				"target": "/user/21/accounts",
				"method": "POST",				
				"query": {
					"holder_id": 41
				},				
				"inputs": {
					"alias": "nickname-{xtime}",
					"limkey": "xy-{random}"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-holder to edit an account's alias",
				"target": "/user/21/accounts",
				"method": "POST",				
				"query": {
					"holder_id": 44
				},				
				"inputs": {
					"alias": "nickname-{xtime}",
					"limkey": "xy-{random}"
				},
				"status": 403
			}]
		}]
	},
	
	"userCollection": {
		"description": "Default user collection resource, non-admin, non-self.",
		
		"properties": {
			"required": ["@type", "@id", "numUsers", "earliest", "latest"],
			"optional": ["links", "actions"]
		},
		
		"actions": [{
			"title": "User registration",
			"@type": "form",
			"@id": "/forms#user-registration",
			"method": "POST",
			
			"query": ["holder_id"],
			
			"inputs": {
				"required": ["email", "password", "name"],
				"optional": []
			},
			
			"examples": [{
				"label": "should allow registration by a brand new user",
				"target": "/user/collection",
				"method": "POST",			
				
				"inputs": {
					"email": "john-{xtime}@test.org",
					"name": "John-{xtime}",
					"password": "pass-2"
				},
				"status": 200
			},{
				"label": "should NOT allow user registration with missing email",
				"target": "/user/collection",
				"method": "POST",				
						
				"inputs": {
					"name": "John-{xtime}",
					"password": "pass-2"
				},
				"status": 403
			}]
		}]
	},
	
	"brand": {
		"description": "A budget-issuing organization.",

		"properties": {
			"required": ["@type", "@id", "brand_id", "name", "mission", "description", "created", "tally"],
			"optional": ["links", "actions"]
		},
		
		"actions": [{
			"title": "Edit",
			"@type": "form",
			"@id": "/forms#brand-edit",
			"method": "POST",
			"inputs": {
				"required": [],
				"optional": ["name", "url", "mission", "description"]
			},
			
			"examples": [{
				"label": "should allow an admin to edit a brand's info",
				"target": "/brand/104",
				"method": "POST",
				"inputs": {
					"mission": "another mission -{xtime}",
					"description": "another description -{xtime}"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-admin to edit a brand's alias",
				"target": "/brand/105",
				"method": "POST",				
				"query": {
					"holder_id": 44
				},				
				"inputs": {
					"mission": "non-admin's brand mission -{xtime}",
					"description": "non-admin's brand description -{xtime}"
				},
				"status": 403
			}]
		}]
	},
	
	"brandMembers": {
		"description": "All users that are current members of a brand.",

		"properties": {
			"required": ["@type", "@id", "brand_id", "items"],
			"optional": ["links", "actions"]
		},
		
		"actions": [
		{
			"title": "Edit",
			"@type": "form",
			"@id": "/forms#admin-member-edit",
			"method": "POST",
			
			"query": {
				"required": ["member_id"],
				"optional": []
			},
			
			"inputs": [{
				"required": [],
				"optional": ["role", "hours"]
			}],
			
			"examples": [{
				"label": "should allow an admin to edit a member's info",
				"target": "/brand/104/members",
				"method": "POST",
				
				"query": {
					"member_id": 55
				},					
				
				"inputs": {
					"role": "assistant -{xtime}",
					"hours": "{random}"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-admin to edit a member's info",
				"target": "/brand/105/members",
				"method": "POST",				
				"query": {
					"member_id": 54
				},					
				
				"inputs": {
					"role": "assistant -{xtime}",
					"hours": "{random}"
				},
				"status": 403
			}]
		},
		{
			"title": "Add a member",
			"@type": "form",
			"@id": "/forms#member-add",
			"method": "POST",
			
			"inputs": [{
				"required": ["user_id", "role", "hours"],
				"optional": []
			}],
			
			"examples": [{
				"label": "should allow an admin to add a brand member",
				"target": "/brand/104/members",
				"method": "POST",
				
				"inputs": {
					"user_id": 24,
					"role": "dev-{xtime}",
					"hours": "{random}"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-admin to add a member",
				"target": "/brand/105/members",
				"method": "POST",				
				
				"inputs": {
					"user_id": 24,
					"role": "dev-{xtime}",
					"hours": "{random}"
				},
				"status": 403
			}]
		}]
	},
	
	"brandAccounts": {
		"description": "The accounts administered by a brand.",

		"properties": {
			"required": ["@type", "@id", "brand_id", "items"],
			"optional": ["links", "actions"]
		},
		
		"actions": [
		{
			"title": "Edit",
			"@type": "form",
			"@id": "/forms#admin-account-edit",
			"method": "POST",
			
			"inputs": [{
				"name": {"required": false},
				"authcode": {"required": false}
			}],
			
			"examples": [{
				"label": "should allow an admin to edit an account's info",
				"target": "/brand/104/accounts",
				"method": "POST",
				
				"query": {
					"account_id": 94
				},					
				
				"inputs": {
					"name": "personal -{xtime}",
					"authcode": "ft -{random}"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-admin to edit an account's info",
				"target": "/brand/105/accounts",
				"method": "POST",				
				"query": {
					"account_id": 97
				},					
				
				"inputs": {
					"name": "personal -{xtime}",
					"authcode": "{random}"
				},
				"status": 403
			}]
		},
		{
			"title": "Add an account",
			"@type": "form",
			"@id": "/forms#account-add",
			"method": "POST",
			
			"inputs": [{
				"required": ["name", "authcode", "unit", "sign"],
				"optional": []
			}],
			
			"examples": [{
				"label": "should allow an admin to add a new account",
				"target": "/brand/104/accounts",
				"method": "POST",
				
				"inputs": {
					"name": "test -{xtime}",
					"authcode": "cftix",
					"unit": "hour"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-admin to add a member",
				"target": "/brand/105/accounts",
				"method": "POST",				
				
				"inputs": {
					"name": "test -{xtime}",
					"authcode": "cftix",
					"unit": "hour"
				},
				"status": 403
			}]
		}]
	},
	
	"brandHolders": {
		"description": "Those users who are currently assigned an account administered by a brand.",

		"properties": {
			"required": ["@type", "@id", "brand_id", "items"],
			"optional": ["links", "actions"]
		},
		
		"actions": [
		{
			"title": "Edit",
			"@type": "form",
			"@id": "/forms#admin-holder-edit",
			"method": "POST",
			
			"inputs": {
				"required": ["authcode"],
				"optional": []
			},		
		
			"examples": [{
				"label": "should allow an admin to edit a holder's authcode",
				"target": "/brand/104/holders",
				"method": "POST",
				
				"query": {
					"holder_id": 43
				},					
				
				"inputs": {
					"authcode": "{random}"
				},
				"status": 200
			},{
				"label": "should NOT allow a non-admin to edit an account's info",
				"target": "/brand/105/holders",
				"method": "POST",				
				"query": {
					"holder_id": 44
				},					
				
				"inputs": {
					"name": "personal -{xtime}",
					"authcode": "{random}"
				},"status": 403
			}]
		},
		{
			"title": "Add an account holder",
			"@type": "form",
			"@id": "/forms#holder-add",
			"method": "POST",
			
			"inputs": [{
				"required": ["user_id", "account_id", "authcode"],
				"optional": []
			}],
			
			"examples": [{
				"label": "should allow an admin to add a new accountholder",
				"target": "/brand/104/holders",
				"method": "POST",
				
				"inputs": {
					"user_id": 24,
					"account_id": 94,
					"authcode": "cftix"
				},
				"status": 200
			},{
				"label": "should NOT allow an admin to add a new accountholder",
				"target": "/brand/105/holders",
				"method": "POST",
				
				"inputs": {
					"user_id": 24,
					"account_id": 96,
					"authcode": "cftix"
				},
				"status": 403
			}]
		}]
	},
	
	"brandAbout": {
		"description": "",
		"link": "",

		"properties": {
			"":	{
				"type": "",
				"regex": ""
			}
		},
		
		"actions": {
			"":	{
				"type": "",
				"regex": ""
			}
		}
	},
	
	
	"brandCollection": {
		"description": "Default brand collection resource, non-admin, non-self.",
		
		"properties": {
			"required": ["@type", "@id", "numBrands", "earliest", "latest"],
			"optional": ["links", "actions"]
		},
		
		"actions": [{
			"title": "Brand registration",
			"@type": "form",
			"@id": "/forms#brand-registration",
			"method": "POST",
			
			"inputs": {
				"required": ["name", "mission", "description"],
				"optional": []
			},
			
			"examples": [{
				"label": "should allow registration by a brand new user",
				"target": "/brand/collection",
				"method": "POST",			
				
				"inputs": {
					"name": "abc-{xtime}.org",
					"mission": "To be the first brand - {xtime}",
					"description": "the third brand"
				},
				"status": 200
			},{
				"label": "should NOT allow user registration with missing mission",
				"target": "/brand/collection",
				"method": "POST",				
							
				"inputs": {
					"name": "xyz-{xtime}.org",
					"description": "the third brand"
				},
				"status": 403
			}]
		}]
	},
	
	"budgetIssued": {
		"description": "The first part of the budget lifecycle, with the brand issuing equivalent debits and credits to its N and P-type accounts, respectively.",

		"properties": {
			"required": ["@type", "@id", "brand_id", "items"],
			"optional": ["links", "actions"]
		},
		
		"actions": [{
			"title": "Issue budget",
			"@type": "form",
			"@id": "/forms#budget-add",
			"method": "POST",
			
			"inputs": [{
				"required": ["from", "to", "amount", "note"],
				"optional": []
			}],
			
			"examples": [{
				"label": "should allow an accountholding with a 'c' authcode to issue budget",
				"target": "/budget/104/issued",
				"method": "POST",
				
				"inputs": {
					"from": "41-abc",
					"to": "42-abc",
					"amount": 200,
					"note": "test budget issuance"
				},
				"status": 200
			},{
				"label": "should NOT allow an accountholding without a 'c' authcode to issue budget",
				"target": "/budget/104/issued",
				"method": "POST",
				
				"inputs": {
					"from": "41-abc",
					"to": "43-abc",
					"amount": 200,
					"note": "test budget issuance"
				},
				"status": 403
			}]
		}]
	},
	
	"budgetTransferred": {
		"description": "The intermediate part of the budget lifecycle, with budgets being transferred between accounts of the same brand.",

		"properties": {
			"required": ["@type", "@id", "brand_id", "items"],
			"optional": ["links", "actions"]
		},
		
		"actions": [{
			"title": "Assign budget",
			"@type": "form",
			"@id": "/forms#budget-transfer",
			"method": "POST",
			
			"inputs": [{
				"required": ["from", "to", "amount", "note"],
				"optional": []
			}],
			
			"examples": [{
				"label": "should allow an originating accountholding with an 'f' and destination accountholding with a 't' authcode to transfer budgets.",
				"target": "/budget/104/transferred",
				"method": "POST",
				
				"inputs": {
					"from": "42-abc",
					"to": "43-abc",
					"amount": 22.00,
					"note": "test budget transfer"
				},
				"status": 200
			}]
		}]
	},
	
	"budgetUsed": {
		"description": "The last part of the budget lifecycle, with credits getting cancelled with an equivalent amount of debits, mostly expected to be between brands.",

		"properties": {
			"required": ["@type", "@id", "brand_id", "items"],
			"optional": ["links", "actions"]
		},
		
		"actions": [{
			"title": "Use budget",
			"@type": "form",
			"@id": "/forms#budget-use",
			"method": "POST",
			
			"inputs": [{
				"required": ["from", "to", "amount", "note"],
				"optional": []
			}],
			
			"examples": [{
				"label": "should allow an accountholding with an 'x' to use budgets.",
				"target": "/budget/104/used",
				"method": "POST",
				
				"inputs": {
					"from": "42-abc",
					"to": "44-abc",
					"amount": 11.11,
					"note": "test budget use"
				},
				"status": 200
			}]
		}]
	}
}
	
